<mach-ii version="1.5">

	<!-- PROPERTIES -->
	<properties>
		<property name="defaultEvent" value="HomePage" />
		<property name="applicationRoot" value="/u4u" />
		<property name="eventParameter" value="event" />
		<property name="parameterPrecedence" value="form" />
		<property name="maxEvents" value="20" />
		<property name="exceptionEvent" value="exception" />
		
		<!-- Used for SES -->
		<property name="urlBase" value="index.cfm" />
		<property name="urlParseSES" value="false" />
		<property name="urlDelimiters" value="/|/|/" />
	</properties>

	<!-- LISTENERS -->
	<listeners>
		<listener name="AdminManager" type="u4u.FunctionPages.Admin">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="AccountManager" type="u4u.FunctionPages.Accounts">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="AdvertisementManager" type="u4u.FunctionPages.Advertisements">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="CommunityManager" type="u4u.FunctionPages.Communities">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="CommunityCategoryManager" type="u4u.FunctionPages.CommunityCategories">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="CommunityPostManager" type="u4u.FunctionPages.CommunityPosts">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="CourseManager" type="u4u.FunctionPages.Courses">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="DealManager" type="u4u.FunctionPages.Deals">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="DealCategoryManager" type="u4u.FunctionPages.DealCategories">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="EmailManager" type="u4u.FunctionPages.Emails">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="EventManager" type="u4u.FunctionPages.Events">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="EventCategoryManager" type="u4u.FunctionPages.EventCategories">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="GeographyManager" type="u4u.FunctionPages.Geography">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="JobManager" type="u4u.FunctionPages.Jobs">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="JobCategoryManager" type="u4u.FunctionPages.JobCategories">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="LatestActivityManager" type="u4u.FunctionPages.LatestActivity">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>		
		<listener name="LinkManager" type="u4u.FunctionPages.Links">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="LocationManager" type="u4u.FunctionPages.Locations">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="MarketplaceManager" type="u4u.FunctionPages.Marketplace">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="MarketplaceCategoryManager" type="u4u.FunctionPages.MarketplaceCategories">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="PageManager" type="u4u.FunctionPages.Pages">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>		
		<listener name="SchoolManager" type="u4u.FunctionPages.Schools">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="StudyGroupManager" type="u4u.FunctionPages.StudyGroups">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="StudyGroupPostManager" type="u4u.FunctionPages.StudyGroupPosts">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
		<listener name="UserManager" type="u4u.FunctionPages.Users">
			<invoker type="MachII.framework.invokers.EventArgsInvoker" />	
		</listener>
	</listeners>
	
	<!-- EVENT FILTERS -->
	<event-filters>
		<event-filter name="eventArgs" type="MachII.filters.EventArgsFilter" />		
	</event-filters>
	
	<!-- INCLUDES -->
	<includes />	

	<event-handlers>
	
	<!-- HOMEPAGE -->
		
		<event-handler event="Homepage">		
			<notify listener="UserManager" method="GetHomePage" />
		</event-handler>
				
		<event-handler event="HomePage.Visitor">
			<notify listener="AdminManager" method="GetCaptchaFields" resultKey="request.CaptchaFields"  />
		
			<event-arg name="Status" value="1" />
			<notify listener="SchoolManager" method="GetDisplaySchools" resultKey="request.Schools" />			
			<event-arg name="FieldName" value="School" />
			<event-arg name="FieldID" value="SchoolOptions" />
			<event-arg name="DataQuery" variable="request.Schools" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="FirstLabel" value="School" />
			<event-arg name="SelectedValue" variable="" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.SchoolBox" />
			
			<execute subroutine="AdBannerRight" />
			<view-page name="LatestActivityWrapper" contentKey="request.LatestActivityWrapper" />
			<view-page name="HomePageVisitor" contentKey="request.content" />
			<view-page name="mainDisplayPage" />
		</event-handler>
		
		<event-handler event="HomePage.User">
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			
			<event-arg name="UserID" variable="Request.UserID" />
			<notify listener="LatestActivityManager" method="GetUserRecentActivity" resultKey="request.RecentActivity"  />
			<view-page name="UserRecentActivity" contentKey="request.UserRecentActivity" />		
			<view-page name="LatestActivityWrapper" contentKey="request.LatestActivityWrapper" />
			<view-page name="HomePageUser" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />
		</event-handler>
		
		<event-handler event="HomePage.LatestActivity">		
			<execute subroutine="GetPaginationStart" />			
			<notify listener="LatestActivityManager" method="GetLatestActivity" resultKey="request.LatestActivity"  />	
			<event-arg name="GridQuery" variable="request.LatestActivity" />
			<execute subroutine="GetPaginationEnd" />
			
			<view-page name="TheLatestActivity" />
		</event-handler>
		
	<!-- AUTHENTICATION -->

		<event-handler event="Login">		
			<execute subroutine="AdBannerRight" />
			<view-page name="LoginForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Login.Verify">		
			<event-arg name="KeyInclusionList" value="username" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<event-arg name="InputValue" variable="Password" />
			<notify listener="AdminManager" method="GetHashedValue" resultKey="request.HashedPassword"  />
			<event-arg name="Password" variable="request.HashedPassword" />
			
			<notify listener="UserManager" method="VerifyLogin" /> 
		</event-handler>
		
		<event-handler event="Logout" access="public">					
			<notify listener="UserManager" method="Logout" />
		</event-handler>
		
		<event-handler event="User.Password.Forgot">
			<execute subroutine="AdBannerRight" />
			
			<view-page name="ForgotPasswordForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="User.Password.Reset">			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="UserManager" method="ResetPassword" />			
		</event-handler>
		
		<event-handler event="User.Password.Change">
			<event-arg name="SuccessDestination" value="/password-change.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			
			<view-page name="PasswordForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="User.Password.Submit">	
			<execute subroutine="EnforceLogin" />
			
			<event-arg name="AccountID" variable="Request.UserID" />
			
			<event-arg name="InputValue" variable="PasswordExisting" />
			<notify listener="AdminManager" method="GetHashedValue" resultKey="request.HashedPasswordExisting"  />
			<event-arg name="PasswordExisting" variable="request.HashedPasswordExisting" />
			
			<event-arg name="InputValue" variable="Password" />
			<notify listener="AdminManager" method="GetHashedValue" resultKey="request.HashedPassword" />
			<event-arg name="Password" variable="request.HashedPassword" />
			
			<notify listener="UserManager" method="UpdatePassword" />
		</event-handler>
		
		<event-handler event="User.Profile.Create" access="public">	
			<execute subroutine="ValidateCaptcha" />
			<notify listener="AccountManager" method="CreateAccount" />		
		</event-handler>
		
		<event-handler event="User.Profile.CheckUsername" access="public">	
			<notify listener="AccountManager" method="GetUsernameAvailability" />		
		</event-handler>
		
		<event-handler event="User.Profile.View">
			<execute subroutine="AdBannerRight" />
			<notify listener="AccountManager" method="GetProfileDetails" resultKey="request.Profile" />
			
			<event-arg name="InputQuery" variable="Request.Profile" />
			<execute subroutine="VerifyAvailability" />	
			
			<view-page name="ProfileDetails" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />
		</event-handler>
		
		<event-handler event="User.Profile.Edit">	
			<event-arg name="SuccessDestination" value="/profile-edit.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="GetAccountDetails" resultKey="request.Account" />
			
			<event-arg name="Status" value="1" />
			
			<!---event-arg name="IsDisabled" value="1" /-->
			<notify listener="SchoolManager" method="GetDisplaySchools" resultKey="request.Schools" />			
			<event-arg name="FieldName" value="School" />
			<event-arg name="FieldID" value="SchoolOptions" />
			<event-arg name="DataQuery" variable="request.Schools" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.Account.SchoolID" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.SchoolBox" />
			
			<!--event-arg name="IsDisabled" value="0" /-->
			<notify listener="GeographyManager" method="GetStates" resultKey="request.States" />			
			<event-arg name="FieldName" value="State" />
			<event-arg name="FieldID" value="StateOptions" />
			<event-arg name="DataQuery" variable="request.States" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Label" />
			<event-arg name="SelectedValue" variable="Request.Account.State" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.StateBox" />
			
			<event-arg name="FieldName" value="TermsAndConditions" />
			<event-arg name="SelectedValue" variable="request.Account.TermsAndConditions" />
			<notify listener="AdminManager" method="GetBooleanBox" resultKey="request.TermsBox" />
			
			<view-page name="ProfileForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="User.Profile.Submit" access="public">	
			<event-arg name="SuccessDestination" value="/profile-edit.html" />
			<execute subroutine="EnforceLogin" />
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<event-arg name="InputValue" variable="Password" />
			<notify listener="AdminManager" method="GetHashedValue" resultKey="request.HashedPassword"  />
			<event-arg name="Password" variable="request.HashedPassword" />
			<event-arg name="ReturnUrl" value="/profile-updated.html" />

			<event-arg name="KeyInclusionList" value="FirstName,LastName,Email,Street1,Street2,City,ZipCode,PhoneNumber,URL,Signature" />
			<notify listener="AdminManager" method="LaunderInputs" />			
			<notify listener="AccountManager" method="UpdateAccount" />		
		</event-handler>
		
		<event-handler event="User.Profile.Picture">	
			<event-arg name="SuccessDestination" value="/profile-avatar.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			
			<event-arg name="AccountID" variable="Request.UserID" />
			
			<event-arg name="ItemID" variable="Request.UserID" />
			<event-arg name="ItemKey" value="User" />
			<notify listener="AdminManager" method="GetItemThumbnail" resultKey="request.ItemThumbnailPath" />
			<notify listener="AdminManager" method="GetItemFullsize" resultKey="request.ItemFullsizePath" />
			
			<view-page name="ProfilePictureForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="User.Profile.Picture.Submit" access="public">	
			<event-arg name="SuccessDestination" value="/profile-avatar.html" />
			<execute subroutine="EnforceLogin" />
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="UpdateAccountPicture" />		
		</event-handler>
		
		<event-handler event="User.Profile.CancelConfirm" access="public">	
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			
			<view-page name="ProfileCancelForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />
		</event-handler>
		
		<event-handler event="User.Profile.Cancel" access="public">	
			<execute subroutine="EnforceLogin" />
			
			<event-arg name="AccountID" variable="Request.UserID" />			
			<notify listener="AccountManager" method="CancelAccount" />		
			<notify listener="UserManager" method="Logout" />
		</event-handler>
		
		<event-handler event="User.Contact.Form">				
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="GetAccountDetails" resultKey="request.Account" />
			
			<view-page name="UserContactForm" contentKey="request.content" />
			<view-page name="fancyDisplayPage" />			
		</event-handler>
		
		<event-handler event="User.Contact.Submit">				
			<event-arg name="KeyInclusionList" value="FirstName,LastName,Email,PhoneNumber,Comments" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<notify listener="AccountManager" method="SendContactRequest" />
		</event-handler>
	
	<!-- ADVERTISEMENT -->	
	
		<event-handler event="Advertisement.Click">				
			<event-arg name="AdvertisementID" variable="Form.aid" />
			<event-arg name="PlacementID" variable="Form.pid" />
			<event-arg name="LocationID" variable="Request.LocationID" />			
			<event-arg name="MonetizationModelID" value="2" />
			
			<notify listener="AdvertisementManager" method="GetAdvertisementCost" resultKey="Request.AdvertisementCost" />			
			
			<event-arg name="Cost" variable="Request.AdvertisementCost" />			
			<notify listener="AdvertisementManager" method="TrackAdvertisement" />
		</event-handler>

		<event-handler event="Advertisements.List">	
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceAdvertiser" />
			<execute subroutine="AdBannerRight" />
			
			<notify listener="AdvertisementManager" method="GetDefaultSearchText" resultKey="request.DefaultSearchText" />
			<execute subroutine="GetSearchTerm" />
			
			<event-arg name="User" variable="Request.UserID" />
			<event-arg name="SortOptionsList" value="Title,Budget" />
			<notify listener="AdvertisementManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />
			<notify listener="AdvertisementManager" method="GetAdvertisements" resultKey="Request.Advertisements" />	
			<event-arg name="GridQuery" variable="request.Advertisements" />
			<execute subroutine="GetPaginationEnd" />
			
			<view-page name="AdvertisementList" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>		
	
	<!-- COMMUNITY -->
		
		<event-handler event="Community.List">	
			
			<event-arg name="FirstLabel" value="All Categories" />
			<notify listener="CommunityCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Category" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />
			
			<notify listener="CommunityManager" method="GetDefaultSearchText" resultKey="request.DefaultSearchText" />
			<execute subroutine="GetSearchTerm" />
			
			<event-arg name="SortOptionsList" value="title,category,posts" />
			<notify listener="CommunityManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="CommunityManager" method="GetCommunities" resultKey="request.Communities" />	
			<event-arg name="GridQuery" variable="request.Communities" />
			<execute subroutine="GetPaginationEnd" />	
					
			<view-page name="CommunityList" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Community.Posts">	
			
			<notify listener="CommunityManager" method="GetCommunityDetails" resultKey="request.Community" />
			<event-arg name="InputQuery" variable="Request.Community" />
			<execute subroutine="VerifyAvailability" />				
			
			<event-arg name="SortOptionsList" value="title" />
			<notify listener="CommunityManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="CommunityPostManager" method="GetCommunityPosts" resultKey="request.CommunityPosts" />	
			<event-arg name="GridQuery" variable="request.CommunityPosts" />
			<execute subroutine="GetPaginationEnd" />		
			
			<view-page name="CommunityPosts" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Community.Posts.Form">	
			<event-arg name="SuccessDestination" value="/community.html" />
			<execute subroutine="EnforceLogin" />
			
			<notify listener="CommunityManager" method="GetCommunityDetails" resultKey="request.Community" />
			<event-arg name="InputQuery" variable="Request.Community" />
			<execute subroutine="VerifyAvailability" />			
			
			<notify listener="CommunityPostManager" method="GetCommunityPostDetails" resultKey="request.CommunityPost" />
			
			<view-page name="CommunityPostForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Community.Posts.Form.Submit">	
			<event-arg name="SuccessDestination" value="/community.html" />
			<execute subroutine="EnforceLogin" />
			
			<event-arg name="KeyInclusionList" value="Description" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="CommunityPostManager" method="ReplyToCommunityPost" />
			
			<notify listener="AdminManager" method="GetUrl" /> 
		</event-handler>
		
		<event-handler event="Community.Form">	
			<event-arg name="SuccessDestination" value="/community-post.html" />
			<execute subroutine="EnforceLogin" />
			
			<notify listener="CommunityCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Category" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />
						
			<view-page name="CommunityForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Community.Form.Submit">	
			<event-arg name="SuccessDestination" value="/community-post.html" />
			<execute subroutine="EnforceLogin" />
			
			<event-arg name="KeyInclusionList" value="Title,Description" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="CommunityManager" method="UpdateCommunity" />
		</event-handler>
				
	<!-- DEALS -->
	
		<event-handler event="Deals.Click">				
			<event-arg name="DealID" variable="Form.did" />
			<event-arg name="LocationID" variable="Request.LocationID" />			
			<event-arg name="MonetizationModelID" value="2" />						
			<notify listener="DealManager" method="TrackDeal" />
		</event-handler>
	
		<event-handler event="Deals.List">	
			<execute subroutine="AdBannerRight" />
			
			<event-arg name="FirstLabel" value="All Categories" />
			<notify listener="DealCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Category" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />	
			
			<notify listener="DealManager" method="GetDefaultSearchText" resultKey="request.DefaultSearchText" />
			<execute subroutine="GetSearchTerm" />
			
			<event-arg name="SortOptionsList" value="Title,Category" />
			<notify listener="DealManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="DealManager" method="getDeals" resultKey="request.Deals" />	
			<event-arg name="GridQuery" variable="request.Deals" />
			<execute subroutine="GetPaginationEnd" />
			
			<event-arg name="DealQuery" variable="request.Deals" />
			<event-arg name="LocationID" variable="request.LocationID" />
			<event-arg name="MonetizationModelID" value="1" />
			<notify listener="DealManager" method="TrackDeals" />
					
			<view-page name="DealList" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Deals.Details">	
			<event-arg name="SuccessTargetID" variable="URL.DealID" />
			<event-arg name="SuccessTargetType" value="Deal" />
			<execute subroutine="EnforceLogin" />
		
			<notify listener="DealManager" method="GetDealDetails" resultKey="request.Deal" />	
			<event-arg name="InputQuery" variable="Request.Deal" />
			<execute subroutine="VerifyAvailability" />	
			
			<execute subroutine="AdBannerRight" />
			
			<view-page name="DealDetails" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Deals.Form">	
			<event-arg name="SuccessDestination" value="/deal-post.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceDealer" />
			<execute subroutine="AdBannerRight" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="DealManager" method="GetDealDetails" resultKey="request.Deal" />

			<event-arg name="FieldName" value="StartTime" />
			<event-arg name="SelectedValue" variable="request.Deal.StartTime" />
			<notify listener="AdminManager" method="GetTimeBoxes" resultKey="request.StartTimeBoxes" />
			
			<event-arg name="FieldName" value="EndTime" />
			<event-arg name="SelectedValue" variable="request.Deal.EndTime" />
			<notify listener="AdminManager" method="GetTimeBoxes" resultKey="request.EndTimeBoxes" />	

			<notify listener="DealCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.Deal.CategoryID" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />			

			<notify listener="GeographyManager" method="GetStates" resultKey="request.States" />			
			<event-arg name="FieldName" value="State" />
			<event-arg name="FieldID" value="StateOptions" />
			<event-arg name="DataQuery" variable="request.States" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Label" />
			<event-arg name="SelectedValue" variable="Request.Deal.State" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.StateBox" />		

			<notify listener="DealManager" method="GetMonetizationModels" resultKey="request.MonetizationModels" />			
			<event-arg name="FieldName" value="MonetizationModel" />
			<event-arg name="FieldID" value="MonetizationModelOptions" />
			<event-arg name="DataQuery" variable="request.MonetizationModels" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="request.Deal.MonetizationModelID" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.MonetizationModelBox" />			
						
			<event-arg name="ItemID" variable="Request.Deal.ID" />
			<event-arg name="ItemKey" value="Deal" />
			<notify listener="AdminManager" method="GetItemThumbnail" resultKey="request.ItemThumbnailPath" />
			<notify listener="AdminManager" method="GetItemFullsize" resultKey="request.ItemFullsizePath" />
			
			<view-page name="DealForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />		
		</event-handler>
		
		<event-handler event="Deals.Form.Submit">	
			<event-arg name="SuccessDestination" value="/deal-post.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceDealer" />
			<event-arg name="KeyInclusionList" value="Title,Description,AddressTitle,Street1,Street2,City,State,ZipCode,PhoneNumber,Url,Budget" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="DealManager" method="UpdateDeal" />
		</event-handler>
		
		<event-handler event="Deals.Contact.Form">	
			<notify listener="DealManager" method="GetDealDetails" resultKey="request.Deal" />	
			<event-arg name="InputQuery" variable="Request.Deal" />
			<execute subroutine="VerifyAvailability" />	
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="GetAccountDetails" resultKey="request.Account" />
			
			<view-page name="DealContactForm" contentKey="request.content" />
			<view-page name="fancyDisplayPage" />			
		</event-handler>
		
		<event-handler event="Deals.Contact.Submit">				
			<event-arg name="KeyInclusionList" value="FirstName,LastName,Email,PhoneNumber,Comments" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<notify listener="JobManager" method="SendContactRequest" />
		</event-handler>
		
	<!-- EVENTS -->
		
		<event-handler event="Events.List">	
			<execute subroutine="AdBannerRight" />
			
			<event-arg name="FirstLabel" value="All Categories" />
			<notify listener="EventCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Category" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />
			
			<event-arg name="FirstLabel" value="All Schools" />
			<notify listener="SchoolManager" method="GetDisplaySchools" resultKey="request.Schools" />			
			<event-arg name="FieldName" value="School" />
			<event-arg name="FieldID" value="EventSchoolOptions" />
			<event-arg name="DataQuery" variable="request.Schools" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.School" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.SchoolBox" />
			
			<notify listener="EventManager" method="GetDefaultSearchText" resultKey="request.DefaultSearchText" />
			<execute subroutine="GetSearchTerm" />
			
			<event-arg name="SortOptionsList" value="StartDate,Title" />
			<notify listener="EventManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="EventManager" method="getEvents" resultKey="request.Events" />	
			<event-arg name="GridQuery" variable="request.Events" />
			<execute subroutine="GetPaginationEnd" />
			
			<view-page name="EventList" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Events.Details">	
			<event-arg name="SuccessTargetID" variable="URL.EventID" />
			<event-arg name="SuccessTargetType" value="Event" />
			<execute subroutine="EnforceLogin" />
			
			<notify listener="EventManager" method="GetEventDetails" resultKey="request.Events" />	
			<event-arg name="InputQuery" variable="Request.Events" />
			<execute subroutine="VerifyAvailability" />	
			
			<execute subroutine="AdBannerRight" />
			
			<view-page name="EventDetails" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Events.Form">	
			<event-arg name="SuccessDestination" value="/event-post.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="EventManager" method="GetEventDetails" resultKey="request.Events" />
			
			<notify listener="SchoolManager" method="GetDisplaySchools" resultKey="request.Schools" />			
			<event-arg name="FieldName" value="School" />
			<event-arg name="FieldID" value="StudyGroupSchoolOptions" />
			<event-arg name="DataQuery" variable="request.Schools" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.Events.SchoolID" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.SchoolBox" />

			<notify listener="EventCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.Events.CategoryID" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />	

			<event-arg name="FieldName" value="StartTime" />
			<event-arg name="SelectedValue" variable="request.Events.StartTime" />
			<notify listener="AdminManager" method="GetTimeBoxes" resultKey="request.StartTimeBoxes" />
			
			<event-arg name="FieldName" value="EndTime" />
			<event-arg name="SelectedValue" variable="request.Events.EndTime" />
			<notify listener="AdminManager" method="GetTimeBoxes" resultKey="request.EndTimeBoxes" />			

			<notify listener="GeographyManager" method="GetStates" resultKey="request.States" />			
			<event-arg name="FieldName" value="State" />
			<event-arg name="FieldID" value="StateOptions" />
			<event-arg name="DataQuery" variable="request.States" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Label" />
			<event-arg name="SelectedValue" variable="Request.Events.State" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.StateBox" />			
						
			<event-arg name="ItemID" variable="Request.Events.ID" />
			<event-arg name="ItemKey" value="Event" />
			<notify listener="AdminManager" method="GetItemThumbnail" resultKey="request.ItemThumbnailPath" />
			<notify listener="AdminManager" method="GetItemFullsize" resultKey="request.ItemFullsizePath" />
			
			<view-page name="EventForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />		
		</event-handler>
		
		<event-handler event="Events.Form.Submit">	
			<event-arg name="SuccessDestination" value="/event-post.html" />
			<execute subroutine="EnforceLogin" />
			<event-arg name="KeyInclusionList" value="Title,Description,Category,StartDate,EndDate,Price" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="EventManager" method="UpdateEvent" />
		</event-handler>
		
		<event-handler event="Events.Contact.Form">	
			<notify listener="EventManager" method="GetEventDetails" resultKey="request.Event" />	
			<event-arg name="InputQuery" variable="Request.Event" />
			<execute subroutine="VerifyAvailability" />	
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="GetAccountDetails" resultKey="request.Account" />
			
			<view-page name="EventContactForm" contentKey="request.content" />
			<view-page name="fancyDisplayPage" />			
		</event-handler>
		
		<event-handler event="Events.Contact.Submit">				
			<event-arg name="KeyInclusionList" value="FirstName,LastName,Email,PhoneNumber,Comments" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<notify listener="EventManager" method="SendContactRequest" />
		</event-handler>
	
	<!-- JOBS -->

		<event-handler event="Jobs.List">	
			<execute subroutine="AdBannerRight" />
			
			<event-arg name="FirstLabel" value="All Categories" />
			<notify listener="JobCategoryManager" method="GetJobCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Category" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />
			
			<notify listener="JobManager" method="GetDefaultSearchText" resultKey="request.DefaultSearchText" />
			<execute subroutine="GetSearchTerm" />
			
			<event-arg name="SortOptionsList" value="Title" />
			<notify listener="JobManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="JobManager" method="getJobs" resultKey="request.Jobs" />	
			<event-arg name="GridQuery" variable="request.Jobs" />
			<execute subroutine="GetPaginationEnd" />
			
			<view-page name="JobList" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />					
		</event-handler>
		
		<event-handler event="Jobs.Details">	
			<event-arg name="SuccessTargetID" variable="URL.JobID" />
			<event-arg name="SuccessTargetType" value="Job" />
			<execute subroutine="EnforceLogin" />
			
			<notify listener="JobManager" method="GetJobDetails" resultKey="request.Job" />	
			<event-arg name="InputQuery" variable="Request.Job" />
			<execute subroutine="VerifyAvailability" />	
			
			<execute subroutine="AdBannerRight" />
			
			<view-page name="JobDetails" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Jobs.Form">				
			<event-arg name="SuccessDestination" value="/job-post.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="JobManager" method="GetJobDetails" resultKey="request.Job" />

			<notify listener="JobCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.Job.CategoryID" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />	

			<notify listener="GeographyManager" method="GetStates" resultKey="request.States" />			
			<event-arg name="FieldName" value="State" />
			<event-arg name="FieldID" value="StateOptions" />
			<event-arg name="DataQuery" variable="request.States" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Label" />
			<event-arg name="SelectedValue" variable="Request.Job.State" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.StateBox" />			
						
			<event-arg name="ItemID" variable="Request.Job.ID" />
			<event-arg name="ItemKey" value="Job" />
			<notify listener="AdminManager" method="GetItemThumbnail" resultKey="request.ItemThumbnailPath" />
			<notify listener="AdminManager" method="GetItemFullsize" resultKey="request.ItemFullsizePath" />
			
			<view-page name="JobForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />		
		</event-handler>
		
		<event-handler event="Jobs.Form.Submit">
			<event-arg name="SuccessDestination" value="/job-post.html" />
			<execute subroutine="EnforceLogin" />
			<event-arg name="KeyInclusionList" value="Title,Description,CompanyName,ContactName,ReplyEmail,AddressTitle,Street1,Street2,City,State,ZipCode,PhoneNumber,Url" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="JobManager" method="UpdateJob" />
		</event-handler>
		
		<event-handler event="Jobs.Contact.Form">	
			<notify listener="JobManager" method="GetJobDetails" resultKey="request.Job" />	
			<event-arg name="InputQuery" variable="Request.Job" />
			<execute subroutine="VerifyAvailability" />	
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="GetAccountDetails" resultKey="request.Account" />
			
			<view-page name="JobContactForm" contentKey="request.content" />
			<view-page name="fancyDisplayPage" />			
		</event-handler>
		
		<event-handler event="Jobs.Contact.Submit">				
			<event-arg name="KeyInclusionList" value="FirstName,LastName,Email,PhoneNumber,Comments" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<notify listener="JobManager" method="SendContactRequest" />
		</event-handler>
	
	<!-- MARKETPLACE -->

		<event-handler event="Marketplace.List">	
			<execute subroutine="AdBannerRight" />
			
			<event-arg name="FirstLabel" value="All Categories" />
			<notify listener="MarketplaceCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Category" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />
			
			<notify listener="MarketplaceManager" method="GetDefaultSearchText" resultKey="request.DefaultSearchText" />
			<execute subroutine="GetSearchTerm" />
			
			<event-arg name="SortOptionsList" value="title,category,price" />
			<notify listener="MarketplaceManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="MarketplaceManager" method="getItems" resultKey="request.Marketplace" />	
			<event-arg name="GridQuery" variable="request.Marketplace" />
			<execute subroutine="GetPaginationEnd" />	
			
			<view-page name="MarketplaceList" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Marketplace.Details">	
			<event-arg name="SuccessTargetID" variable="URL.ItemID" />
			<event-arg name="SuccessTargetType" value="Marketplace" />
			<execute subroutine="EnforceLogin" />
			
			<notify listener="MarketplaceManager" method="GetItemDetails" resultKey="request.Item" />	
			<event-arg name="InputQuery" variable="Request.Item" />
			<execute subroutine="VerifyAvailability" />	
			
			<execute subroutine="AdBannerRight" />
			
			<view-page name="MarketplaceDetails" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="Marketplace.Form">	
			<event-arg name="SuccessDestination" value="/marketplace-post.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="AdBannerRight" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="MarketplaceManager" method="GetItemDetails" resultKey="request.Item" />

			<notify listener="MarketplaceCategoryManager" method="GetDisplayCategories" resultKey="request.Categories" />			
			<event-arg name="FieldName" value="Category" />
			<event-arg name="FieldID" value="CategoryOptions" />
			<event-arg name="DataQuery" variable="request.Categories" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.Item.CategoryID" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CategoryBox" />
						
			<event-arg name="ItemID" variable="Request.Item.ID" />
			<event-arg name="ItemKey" value="Marketplace" />
			<notify listener="AdminManager" method="GetItemThumbnail" resultKey="request.ItemThumbnailPath" />
			<notify listener="AdminManager" method="GetItemFullsize" resultKey="request.ItemFullsizePath" />
			
			<view-page name="MarketplaceForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />		
		</event-handler>
		
		<event-handler event="Marketplace.Form.Submit">
			<event-arg name="SuccessDestination" value="/marketplace-post.html" />
			<execute subroutine="EnforceLogin" />
			<event-arg name="KeyInclusionList" value="Title,Description,Category,StartDate,EndDate,Price" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="MarketplaceManager" method="UpdateItem" />
		</event-handler>
		
		<event-handler event="Marketplace.Contact.Form">	
			<notify listener="MarketplaceManager" method="GetItemDetails" resultKey="request.Item" />	
			<event-arg name="InputQuery" variable="Request.Item" />
			<execute subroutine="VerifyAvailability" />	
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="GetAccountDetails" resultKey="request.Account" />
			
			<view-page name="MarketplaceContactForm" contentKey="request.content" />
			<view-page name="fancyDisplayPage" />			
		</event-handler>
		
		<event-handler event="Marketplace.Contact.Submit">				
			<event-arg name="KeyInclusionList" value="FirstName,LastName,Email,PhoneNumber,Comments" />
			<notify listener="AdminManager" method="LaunderInputs" />
			<notify listener="MarketplaceManager" method="SendContactRequest" />
		</event-handler>
		
	<!-- STUDY GROUPS -->
	
		<event-handler event="StudyGroups.List">
			
			<event-arg name="FirstLabel" value="School:" />
			<notify listener="SchoolManager" method="GetDisplaySchools" resultKey="request.Schools" />			
			<event-arg name="FieldName" value="School" />
			<event-arg name="FieldID" value="StudyGroupSchoolOptions" />
			<event-arg name="DataQuery" variable="request.Schools" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.School" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.SchoolBox" />
			
			<event-arg name="School" variable="Request.SearchParams.School" />
			
			<event-arg name="FirstLabel" value="Course:" />
			<notify listener="CourseManager" method="GetDisplayCourses" resultKey="request.Courses" />			
			<event-arg name="FieldName" value="Course" />
			<event-arg name="FieldID" value="StudyGroupCourseOptions" />
			<event-arg name="DataQuery" variable="request.Courses" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Course" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.CourseBox" />
			
			<notify listener="StudyGroupManager" method="GetDefaultSearchText" resultKey="request.DefaultSearchText" />
			<execute subroutine="GetSearchTerm" />
			
			<event-arg name="SortOptionsList" value="title,course,posts" />
			<notify listener="StudyGroupManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="StudyGroupManager" method="GetStudyGroups" resultKey="request.StudyGroups" />	
			<event-arg name="GridQuery" variable="request.StudyGroups" />
			<execute subroutine="GetPaginationEnd" />	
					
			<view-page name="StudyGroupList" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="StudyGroups.Posts">	
			<event-arg name="SuccessDestination" value="/study-groups.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceSchool" />
			
			<notify listener="StudyGroupManager" method="GetStudyGroupDetails" resultKey="request.StudyGroup" />
			<event-arg name="InputQuery" variable="Request.StudyGroup" />
			<execute subroutine="VerifyAvailability" />				
			
			<event-arg name="SortOptionsList" value="title" />
			<notify listener="StudyGroupManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="StudyGroupPostManager" method="GetStudyGroupPosts" resultKey="request.StudyGroupPosts" />	
			<event-arg name="GridQuery" variable="request.StudyGroupPosts" />
			<execute subroutine="GetPaginationEnd" />		
			
			<view-page name="StudyGroupPosts" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="StudyGroups.Posts.Form">	
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceSchool" />
			
			<notify listener="StudyGroupManager" method="GetStudyGroupDetails" resultKey="request.StudyGroup" />
			<event-arg name="InputQuery" variable="Request.StudyGroup" />
			<execute subroutine="VerifyAvailability" />			
			
			<notify listener="StudyGroupPostManager" method="GetStudyGroupPostDetails" resultKey="request.StudyGroupPost" />
			
			<view-page name="StudyGroupPostForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="StudyGroups.Posts.Form.Submit">	
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceSchool" />
			
			<event-arg name="KeyInclusionList" value="Description" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="StudyGroupPostManager" method="ReplyToStudyGroupPost" />
			
			<notify listener="AdminManager" method="GetUrl" /> 
		</event-handler>
		
		<event-handler event="StudyGroups.Form">	
			<event-arg name="SuccessDestination" value="/study-groups.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceSchool" />
			
			<notify listener="CourseManager" method="GetCourseDetails" resultKey="request.Course" />
			<event-arg name="SchoolID" variable="request.Course.SchoolID" />
			<notify listener="SchoolManager" method="GetSchoolDetails" resultKey="request.School" />
								
			<view-page name="StudyGroupForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="StudyGroups.Form.Submit">	
			<event-arg name="SuccessDestination" value="/study-groups.html" />
			<execute subroutine="EnforceLogin" />
			<execute subroutine="EnforceSchool" />
			
			<event-arg name="KeyInclusionList" value="Title,Description" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<event-arg name="User" variable="Request.UserID" />
			<notify listener="StudyGroupManager" method="UpdateStudyGroup" />
		</event-handler>
		
	<!-- FANCY BOXES -->
	
		<event-handler event="Map">				
			<notify listener="AccountManager" method="GetAddressDetails" resultKey="request.Address" />	
			<event-arg name="InputQuery" variable="Request.Address" />
			<view-page name="Map" contentKey="request.content" />
			<view-page name="fancyDisplayPage" />				
		</event-handler>
		
	<!-- CONTACT US -->
		
		<event-handler event="ContactUs">				
			<execute subroutine="AdBannerRight" />
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AccountManager" method="GetAccountDetails" resultKey="request.Account" />
			
			<view-page name="ContactUsForm" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
		<event-handler event="ContactUs.Submit">				
			<event-arg name="KeyInclusionList" value="FirstName,LastName,Email,PhoneNumber,Comments" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<event-arg name="AccountID" variable="Request.UserID" />
			<notify listener="AdminManager" method="SendContactForm" />
		</event-handler>
		
	<!-- E-MAIL LIST -->
		
		<event-handler event="EmailList.Subscribe">				
			<event-arg name="KeyInclusionList" value="Email" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<notify listener="EmailManager" method="EmailListSubscribe" />
			
			<event-arg name="PageName" value="subscribetoouremaillist" />
			<announce event="PageDetails" copyPartyArgs="true" />
		</event-handler>
		
		<event-handler event="EmailList.Unsubscribe">				
			<event-arg name="KeyInclusionList" value="Email" />
			<notify listener="AdminManager" method="LaunderInputs" />
			
			<notify listener="EmailManager" method="EmailListUnsubscribe" />
			
			<event-arg name="PageName" value="unsubscribefromouremaillist" />
			<announce event="PageDetails" copyPartyArgs="true" />
		</event-handler>
		
	<!-- SEARCH -->
	
		<event-handler event="Search.Results">				
			<execute subroutine="AdBannerRight" />
						
			<event-arg name="SortOptionsList" value="title,category,date" />
			<notify listener="LatestActivityManager" method="GetSortOptions" resultKey="request.SortOptions" />
			<execute subroutine="GetSortOptions" />	
			
			<execute subroutine="GetPaginationStart" />			
			<notify listener="LatestActivityManager" method="GetLatestActivity" resultKey="request.SearchResults"  />
			<event-arg name="GridQuery" variable="request.SearchResults" />
			<execute subroutine="GetPaginationEnd" />			
			
			<view-page name="SearchResults" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />			
		</event-handler>
		
	<!-- CONTENT MANAGEMENT -->
		
		<event-handler event="PageDetails">
			<execute subroutine="AdBannerRight" />
			<notify listener="PageManager" method="GetPageDetail" resultKey="request.PageDetails"  />
			<event-arg name="MetaTitle" variable="Request.PageDetails.MetaTitle" />
			<notify listener="PageManager" method="GetPageMetaTitle" resultKey="request.Meta.Title"  />
			<event-arg name="MetaDescription" variable="Request.PageDetails.MetaDescription" />
			<notify listener="PageManager" method="GetPageMetaDescription" resultKey="request.Meta.Description"  />
			<view-page name="PageDetails" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />	
		</event-handler>
		
		<event-handler event="Unavailable">
			<execute subroutine="AdBannerRight" />
			<view-page name="Unavailable" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />	
		</event-handler>
		
		<event-handler event="AuthorizationFailure">
			<execute subroutine="AdBannerRight" />
			<view-page name="AuthorizationFailure" contentKey="request.pageContent" />
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />	
		</event-handler>
		
	<!-- AJAX -->
	
		<event-handler event="AJAX.GetStudyGroupCourseOptions">
			<event-arg name="FirstLabel" value="Course:" />
			<notify listener="CourseManager" method="GetDisplayCourses" resultKey="request.Courses" />			
			<event-arg name="FieldName" value="Course" />
			<event-arg name="FieldID" value="StudyGroupCourseOptions" />
			<event-arg name="DataQuery" variable="request.Courses" />
			<event-arg name="QueryIDColumn" value="ID" />
			<event-arg name="QueryLabelColumn" value="Title" />
			<event-arg name="SelectedValue" variable="" />
			<notify listener="AdminManager" method="GetSelectBox" resultKey="request.content" />
			<view-page name="blankPage" />	
		</event-handler>
	
		
		<!-- ///////////////////////////////////////////////////////////// -->
		<!-- //////////////////       ERROR EVENTS       ///////////////// -->
		<!-- ///////////////////////////////////////////////////////////// -->
		
		<event-handler event="ErrorPage">
			<view-page name="ErrorPage" contentKey="request.content" />			
			<view-page name="mainDisplayPage" />
		</event-handler>
		
		<!-- ///////////////////////////////////////////////////////////// -->
		<!-- //////////////////       EXCEPTION EVENTS       ///////////////// -->
		<!-- ///////////////////////////////////////////////////////////// -->
		
		<event-handler event="exception">
			<execute subroutine="AdBannerRight" />
			<view-page name="exception" contentKey="request.pageContent" />			
			<view-page name="contentDisplayPage" contentKey="request.content" />
			<view-page name="mainDisplayPage" />
			
		</event-handler>
			
	</event-handlers>
	
	<subroutines>
		<subroutine name="EnforceLogin">
			<notify listener="UserManager" method="EnforceLogin" />
		</subroutine>
		
		<subroutine name="EnforceSchool">
			<notify listener="UserManager" method="EnforceSchool" />
		</subroutine>
		
		<subroutine name="EnforceAdvertiser">
			<notify listener="UserManager" method="EnforceAdvertiser" />
		</subroutine>
		
		<subroutine name="EnforceDealer">
			<notify listener="UserManager" method="EnforceDealer" />
		</subroutine>
		
		<subroutine name="VerifyAvailability">
			<notify listener="AdminManager" method="VerifyAvailability" />
		</subroutine>
		
		<subroutine name="ValidateCaptcha">
			<notify listener="AdminManager" method="ValidateCaptcha" />
		</subroutine>
		
		<subroutine name="AdBannerTop">
			<event-arg name="AdvertisementCount" value="2" />
			<event-arg name="PlacementID" value="1" />
			<event-arg name="LocationID" variable="Request.LocationID" />
			<notify listener="AdvertisementManager" method="GetAdvertisementPlacement" resultKey="request.Placement" />
			<view-page name="AdPlacement" contentKey="request.AdPlacementRight" />
			
			<event-arg name="AdvertisementsQuery" variable="Request.Placement" />
			<event-arg name="MonetizationModelID" value="1" />
			<notify listener="AdvertisementManager" method="TrackAdvertisements" />
		</subroutine>
		
		<subroutine name="AdBannerBottom">
			<event-arg name="AdvertisementCount" value="2" />
			<event-arg name="PlacementID" value="3" />
			<event-arg name="LocationID" variable="Request.LocationID" />
			<notify listener="AdvertisementManager" method="GetAdvertisementPlacement" resultKey="request.Placement" />
			<view-page name="AdPlacement" contentKey="request.AdPlacementRight" />
			
			<event-arg name="AdvertisementsQuery" variable="Request.Placement" />
			<event-arg name="MonetizationModelID" value="1" />
			<notify listener="AdvertisementManager" method="TrackAdvertisements" />
		</subroutine>
		
		<subroutine name="AdBannerRight">
			<event-arg name="AdvertisementCount" value="2" />
			<event-arg name="PlacementID" value="2" />
			<event-arg name="LocationID" variable="Request.LocationID" />
			<notify listener="AdvertisementManager" method="GetAdvertisementPlacement" resultKey="request.Placement" />
			<view-page name="AdPlacement" contentKey="request.AdPlacementRight" />
			
			<event-arg name="AdvertisementsQuery" variable="Request.Placement" />
			<event-arg name="MonetizationModelID" value="1" />
			<notify listener="AdvertisementManager" method="TrackAdvertisements" />
		</subroutine>
		
		<subroutine name="GetPaginationStart">
			<notify listener="AdminManager" method="GetGridRows" resultKey="request.GridRows" />
			<event-arg name="StartRow" variable="request.GridRows.StartRow" />
			<event-arg name="EndRow" variable="request.GridRows.EndRow" />
		</subroutine>
		
		<subroutine name="GetPaginationEnd">
			<notify listener="AdminManager" method="GetGridTotals" resultKey="request.GridTotals" />
			<event-arg name="TotalsStruct" variable="request.GridTotals" />
			<notify listener="AdminManager" method="GetListingPagination" resultKey="request.GridPagination" />
			<notify listener="AdminManager" method="GetRowsFoundLabel" resultKey="request.RowsFoundLabel" />
		</subroutine>
		
		<subroutine name="GetSortOptions">
			<event-arg name="SortOptionsArray" variable="request.SortOptions" />			
			<notify listener="AdminManager" method="GetSortColumn" resultKey="request.SortColumn" />
			<event-arg name="sidx" variable="request.SortColumn" />
			<event-arg name="SelectedValue" variable="Request.SearchParams.Sort" />
			<event-arg name="FirstLabel" value="Sort By:" />
			<notify listener="AdminManager" method="GetSortOptionsBox" resultKey="request.SortBox" />
		</subroutine>
		
		<subroutine name="GetSearchTerm">
			<event-arg name="CurrentSearchText" variable="request.SearchParams.SearchTerm" />
			<event-arg name="DefaultSearchText" variable="request.DefaultSearchText" />
			<notify listener="AdminManager" method="GetSearchTerm" resultKey="request.SearchParams.SearchTerm" />
		</subroutine>
	</subroutines>
	
	<!-- PAGE-VIEWS -->
	<page-views>
	
		<!-- SEO Directory Pages -->
		<page-view name="directory" page="/DisplayPages/directories/directory.cfm" />		
		
		<!-- MAIN DISPLAY PAGES -->
		<page-view name="SEOHeaderInfo" page="/DisplayPages/SEOHeaderInfo.cfm " />
		<page-view name="mainDisplayPage" page="/DisplayPages/MainDisplayPage.cfm" />
		<page-view name="accountDisplayPage" page="/DisplayPages/AccountDisplayPage.cfm" />
		<page-view name="contentDisplayPage" page="/DisplayPages/ContentDisplayPage.cfm" />
		<page-view name="blankDisplayPage" page="/DisplayPages/BlankDisplayPage.cfm" />
		<page-view name="fancyDisplayPage" page="/DisplayPages/FancyDisplayPage.cfm" />
		<page-view name="blankPage" page="/DisplayPages/BlankPage.cfm" />
		
		<!-- VIEWS -->
		<page-view name="HomePageVisitor" page="/DisplayPages/Views/HomePageVisitor.cfm" />
		<page-view name="HomePageUser" page="/DisplayPages/Views/HomePageUser.cfm" />
		<page-view name="LoginForm" page="/DisplayPages/Views/LoginForm.cfm" />
		<page-view name="PasswordForm" page="/DisplayPages/Views/PasswordForm.cfm" />
		<page-view name="ForgotPasswordForm" page="/DisplayPages/Views/ForgotPasswordForm.cfm" />
		<page-view name="ProfileForm" page="/DisplayPages/Views/ProfileForm.cfm" />
		<page-view name="ProfilePictureForm" page="/DisplayPages/Views/ProfilePictureForm.cfm" />
		<page-view name="ProfileCancelForm" page="/DisplayPages/Views/ProfileCancelForm.cfm" />
		<page-view name="ProfileDetails" page="/DisplayPages/Views/ProfileDetails.cfm" />
		<page-view name="UserContactForm" page="/DisplayPages/Views/UserContactForm.cfm" />
		<page-view name="UserRecentActivity" page="/DisplayPages/Views/UserRecentActivity.cfm" />
		<page-view name="LatestActivityWrapper" page="/DisplayPages/Views/LatestActivityWrapper.cfm" />
		<page-view name="TheLatestActivity" page="/DisplayPages/Views/LatestActivity.cfm" />
		
		<page-view name="AdvertisementList" page="/DisplayPages/Views/AdvertisementList.cfm" />
		
		<page-view name="CommunityList" page="/DisplayPages/Views/CommunityList.cfm" />
		<page-view name="CommunityPosts" page="/DisplayPages/Views/CommunityPosts.cfm" />
		<page-view name="CommunityPostForm" page="/DisplayPages/Views/CommunityPostForm.cfm" />
		<page-view name="CommunityForm" page="/DisplayPages/Views/CommunityForm.cfm" />
		
		<page-view name="DealList" page="/DisplayPages/Views/DealList.cfm" />
		<page-view name="DealDetails" page="/DisplayPages/Views/DealDetails.cfm" />
		<page-view name="DealForm" page="/DisplayPages/Views/DealForm.cfm" />
		<page-view name="DealContactForm" page="/DisplayPages/Views/DealContactForm.cfm" />
		
		<page-view name="JobList" page="/DisplayPages/Views/JobList.cfm" />
		<page-view name="JobDetails" page="/DisplayPages/Views/JobDetails.cfm" />
		<page-view name="JobForm" page="/DisplayPages/Views/JobForm.cfm" />
		<page-view name="JobContactForm" page="/DisplayPages/Views/JobContactForm.cfm" />
		
		<page-view name="MarketplaceList" page="/DisplayPages/Views/MarketplaceList.cfm" />
		<page-view name="MarketplaceDetails" page="/DisplayPages/Views/MarketplaceDetails.cfm" />
		<page-view name="MarketplaceForm" page="/DisplayPages/Views/MarketplaceForm.cfm" />
		<page-view name="MarketplaceContactForm" page="/DisplayPages/Views/MarketplaceContactForm.cfm" />
		
		<page-view name="EventList" page="/DisplayPages/Views/EventList.cfm" />
		<page-view name="EventDetails" page="/DisplayPages/Views/EventDetails.cfm" />
		<page-view name="EventForm" page="/DisplayPages/Views/EventForm.cfm" />
		<page-view name="EventContactForm" page="/DisplayPages/Views/EventContactForm.cfm" />
		
		<page-view name="StudyGroupList" page="/DisplayPages/Views/StudyGroupList.cfm" />
		<page-view name="StudyGroupPosts" page="/DisplayPages/Views/StudyGroupPosts.cfm" />
		<page-view name="StudyGroupPostForm" page="/DisplayPages/Views/StudyGroupPostForm.cfm" />
		<page-view name="StudyGroupForm" page="/DisplayPages/Views/StudyGroupForm.cfm" />
		
		<page-view name="SearchResults" page="/DisplayPages/Views/SearchResults.cfm" />
		<page-view name="ContactUsForm" page="/DisplayPages/Views/ContactUsForm.cfm" />
		<page-view name="Map" page="/DisplayPages/Views/Map.cfm" />
		<page-view name="AdPlacement" page="/DisplayPages/Views/AdPlacement.cfm" />
		<page-view name="PageDetails" page="/DisplayPages/Views/PageDetails.cfm" />
		<page-view name="Unavailable" page="/DisplayPages/Views/Unavailable.cfm" />
		<page-view name="AuthorizationFailure" page="/DisplayPages/Views/AuthorizationFailure.cfm" />
		
		<!-- VIEWLETS -->
		<page-view name="Viewlets.Deal" page="/DisplayPages/Views/Viewlets/Deal.cfm" />
		<page-view name="Viewlets.Event" page="/DisplayPages/Views/Viewlets/Event.cfm" />
		<page-view name="Viewlets.Job" page="/DisplayPages/Views/Viewlets/Job.cfm" />
		<page-view name="Viewlets.Marketplace" page="/DisplayPages/Views/Viewlets/Marketplace.cfm" />
		
		<!-- LINKS -->
		<page-view name="Links.Account" page="/DisplayPages/Views/Links/Account.cfm" />
		<page-view name="Links.AccountDetails" page="/DisplayPages/Views/Links/AccountDetails.cfm" />
		<page-view name="Links.Advertisements" page="/DisplayPages/Views/Links/Advertisements.cfm" />
		<page-view name="Links.Community" page="/DisplayPages/Views/Links/Community.cfm" />		
		<page-view name="Links.Deals" page="/DisplayPages/Views/Links/Deals.cfm" />
		<page-view name="Links.Events" page="/DisplayPages/Views/Links/Events.cfm" />
		<page-view name="Links.Jobs" page="/DisplayPages/Views/Links/Jobs.cfm" />
		<page-view name="Links.Marketplace" page="/DisplayPages/Views/Links/Marketplace.cfm" />		
		<page-view name="Links.StudyGroups" page="/DisplayPages/Views/Links/StudyGroups.cfm" />
		
		<!-- OTHER -->
		<page-view name="ErrorPage" page="/DisplayPages/ErrorPage.cfm" />
		<page-view name="exception" page="/DisplayPages/Custom404.cfm" />
		
		
		
	</page-views>
	
	<!-- PLUGINS -->
	<plugins>
	</plugins>

</mach-ii>
